% Load packages
\usepackage{geometry} % For setting page dimensions
\usepackage{xcolor} % For defining and using colors
\usepackage{eso-pic} % For adding elements to each page
\usepackage{fancyhdr} % For custom page headers and footers
\usepackage{sectsty} % For styling section and chapter titles
\usepackage{titlesec} % For customizing section titles
\usepackage{listings} % For including code listings
\usepackage{setspace} % For adjusting line spacing
\usepackage{mfirstuc}

% Define colors
\definecolor{light}{HTML}{D73F09}
\definecolor{highlight}{HTML}{800080}
\definecolor{dark}{HTML}{330033}


% Define page setup variables for letter size
\newcommand{\mypapersize}{letterpaper} % Change from a4paper to letterpaper
\newcommand{\mytotal}{215.9mm,279.4mm} % Dimensions for letter size (8.5in x 11in in mm)
\newcommand{\myleft}{20mm} % You might want to adjust these margins as needed
\newcommand{\mytop}{15mm}
\newcommand{\mybottom}{15mm}
\newcommand{\myright}{30mm}

% Set page setup for letter size
\geometry{\mypapersize, total={\mytotal}, left=\myleft, top=\mytop, bottom=\mybottom, right=\myright}

% Title alignment with custom line spacing
\makeatletter
\renewcommand{\maketitle}{
    \bgroup
    \setlength{\parindent}{0pt}
    \begin{flushleft}
        % Begin a spacing environment for the title section
        \begin{spacing}{1.25}
        {\sffamily\fontsize{25}{20}\textbf{\capitalisewords{\@title}}} \vspace{0.3cm} \newline
        {\large\@author} \newline
        {\large\today} \newline % Include the full date here
        {\large {\@subtitle}} \vspace{-1cm}
        \end{spacing} % End the spacing environment
    \end{flushleft}
    \egroup
}
\makeatother

% Set the main document line spacing to double
\setstretch{1.5} % Or \doublespacing

% Section styles
% Section font settings
\titleformat{\section}{\vspace{-0.5cm}\sffamily\fontsize{18}{20}\bfseries}{\thesection}{1.1em}{}[{\titlerule[0.5pt]}]
\titleformat{\subsection}{\sffamily\fontsize{15}{15}\bfseries}{\thesubsection}{1.1em}{}[{\titlerule[0.5pt]}]
\titleformat{\subsubsection}{\sffamily\fontsize{13}{13}\bfseries}{\thesubsubsection}{1.1em}{}[{\titlerule[0.5pt]}]

% Logo and bar placement
\AddToShipoutPicture{% 
    \AtPageLowerLeft{% 
        \put(\LenToUnit{\dimexpr\paperwidth-2.75cm},25cm){% 
            \color{light}\rule{3.25cm}{3cm}% Adjust the height as needed
        }%
    }%
    \AtPageLowerLeft{% start the bar at the bottom right of the page
        \put(\LenToUnit{\dimexpr\paperwidth-2.6cm},25.2cm){% move it to the top right
            \color{light}\includegraphics[width=2.5cm]{_extensions/OSULatexTheme/logo2.png}
        }%
    }%
}

% Other Page Styling
\fancypagestyle{mystyle}{
  \fancyhf{}
  \fancyfoot[R]{\fontsize{20}{12}\selectfont\thepage} 
  \fancyfootoffset{2cm}
  \setlength{\footskip}{20pt}
}

\pagestyle{mystyle}