% Load packages
\usepackage{geometry} % For setting page dimensions
\usepackage{xcolor} % For defining and using colors
\usepackage{eso-pic} % For adding elements to each page
\usepackage{fancyhdr} % For custom page headers and footers
\usepackage{sectsty} % For styling section and chapter titles
\usepackage{fontspec} % For custom font handling
\usepackage{titlesec} % For customizing section titles
\usepackage{listings} % For including code listings
\usepackage{setspace} % For adjusting line spacing
\usepackage{mfirstuc}

% Define colors
\definecolor{light}{HTML}{D73F09}
\definecolor{highlight}{HTML}{800080}
\definecolor{dark}{HTML}{330033}

%% Define and import custom fonts
\setsansfont{Stratum2}[
    Path=_extensions/OSULatexTheme/Stratum2/,
    Scale=1,
    Extension = .ttf,
    UprightFont=* Medium,
    BoldFont=* Bold,
    ItalicFont=* Regular,
    ]

\setmainfont{Kievit}[
    Path=_extensions/OSULatexTheme/Kievit/,
    Scale=1,
    Extension = .ttf,
    UprightFont=* Regular,
    BoldFont=* Bold,
    ItalicFont=* Black Italic,
    ]

% Define page setup variables
\newcommand{\mypapersize}{a4paper}
\newcommand{\mytotal}{170mm,257mm}
\newcommand{\myleft}{20mm}
\newcommand{\mytop}{15mm}
\newcommand{\mybottom}{15mm}
\newcommand{\myright}{30mm}

% Set page setup
\geometry{\mypapersize, total={\mytotal}, left=\myleft, top=\mytop, bottom=\mybottom, right=\myright}

% Title alignment
\makeatletter
\renewcommand{\maketitle}{\bgroup\setlength{\parindent}{0pt}
\begin{flushleft}
  {\sffamily\fontsize{28}{5}\textbf{\capitalisewords{\@title}}} \vspace{0.3cm} \newline
  {\large\@author} \newline
  {\large\today} \newline % Include the full date here
  {\large {\@subtitle}} \vspace{-0.3cm}
\end{flushleft}\egroup
}

% Set line spacing
\newcommand{\mylinespacing}{1.25} % Adjust the value as needed
\setstretch{\mylinespacing}

% Section styles
% Section font settings
\titleformat{\section}{\sffamily\fontsize{23}{20}\bfseries}{\thesection}{1em}{}[{\titlerule[2.5pt]}]
\titleformat{\subsection}{\sffamily\fontsize{19}{15}\bfseries}{\thesubsection}{1em}{}[{\titlerule[1pt]}]
\titleformat{\subsubsection}{\sffamily\fontsize{15}{10}\bfseries}{\thesubsubsection}{1em}{}[{\titlerule[0.5pt]}]

% Logo and bar placement
\AddToShipoutPicture{% 
    \AtPageLowerLeft{% 
        \put(\LenToUnit{\dimexpr\paperwidth-2.6cm},26.7cm){% 
            \color{light}\rule{3cm}{3cm}% Adjust the height as needed
        }%
    }%
    \AtPageLowerLeft{% start the bar at the bottom right of the page
        \put(\LenToUnit{\dimexpr\paperwidth-2.45cm},27cm){% move it to the top right
            \color{light}\includegraphics[width=2.35cm]{_extensions/OSULatexTheme/logo2.png}
        }%
    }%
}

% Other Page Styling
\fancypagestyle{mystyle}{
  \fancyhf{}
  \renewcommand\headrulewidth{2.5pt}
  \fancyfoot[R]{\fontsize{20}{12}\selectfont\thepage} 
  \fancyfootoffset{2.5cm}
  \setlength{\footskip}{20pt}
}

\pagestyle{mystyle}